<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>로그인 / 비밀번호 찾기</title>
  <link href="https://fonts.googleapis.com/css2?family=SUIT:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'SUIT', sans-serif;
      background-color: #f8f9fa;
      margin: 0;
      padding: 0;
    }
    .top-bar {
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: #ffffff;
      color: #333;
      padding: 12px 20px;
      border-bottom: 1px solid #e0e0e0;
      position: fixed;
      top: 0;
      width: 100%;
      z-index: 1000;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .logo {
      font-size: 1.5rem;
      font-weight: 700;
      cursor: pointer;
      color: #2b6cb0;
      text-decoration: none;
    }
    .top-bar a.home {
      display: none;
    }
    .container {
      max-width: 400px;
      margin: 120px auto 60px auto;
      background: #fff;
      padding: 30px 40px;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    h2 { text-align: center; color: #2c3e50; }
    label { display: block; margin: 15px 0 5px; font-weight: 500; color: #333; }
    input[type="text"], input[type="password"], input[type="email"] {
      width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 15px;
    }
    button {
      width: 100%; padding: 12px;
      background-color: #2b6cb0;
      color: white;
      border: none; border-radius: 8px;
      font-size: 16px; cursor: pointer;
      margin-top: 20px; transition: background-color 0.3s;
    }
    button:hover {
      background-color: #22588f;
    }
    .toggle { text-align: center; margin-top: 25px; color: #555; font-size: 15px; }
    .toggle span, .toggle a span {
      color: #2b6cb0;
      cursor: pointer; font-weight: 600; text-decoration: none;
    }
    .hidden { display: none; }
    .error-message { color: #e74c3c; text-align: center; margin-top: 15px; font-weight: bold; }
    .success-message { color: #27ae60; text-align: center; margin-top: 15px; font-weight: bold; }
    .id-display { color: #2b6cb0; text-align: center; margin-top: 15px; font-size: 18px; font-weight: 700; }
  </style>
</head>
<body>

  <div class="top-bar">
    <a href="main.html" class="logo">Re:Born</a>
  </div>

  <div class="container" id="loginForm">
    <h2>로그인</h2>
    <label for="loginId">아이디</label>
    <input type="text" id="loginId" placeholder="아이디 입력">
    <label for="loginPw">비밀번호</label>
    <input type="password" id="loginPw" placeholder="비밀번호 입력">
    <button onclick="login()">로그인</button>
    <div class="toggle">
      계정이 없으신가요? <a href="signup.html"><span>회원가입</span></a><br>
      아이디/비밀번호를 잊으셨나요? <span onclick="toggleForm('findId')">아이디 찾기</span>/<span onclick="toggleForm('findPw')">비밀번호 찾기</span>
    </div>
  </div>

  <div class="container hidden" id="findIdForm">
    <h2>아이디 찾기</h2>
    <div id="findIdStep1">
      <label for="findIdEmail">가입한 이메일</label>
      <input type="email" id="findIdEmail" placeholder="가입 시 이메일 입력">
      <button onclick="findIdByEmail()">아이디 찾기</button>
      <div id="findIdMsg" class="error-message hidden"></div>
    </div>

    <div id="findIdResult" class="hidden">
      <p>고객님의 아이디는 다음과 같습니다.</p>
      <div id="displayId" class="id-display"></div>
      <button onclick="toggleForm('login')">로그인 화면으로 이동</button>
    </div>

    <div class="toggle">
      <span onclick="toggleForm('login')">← 로그인으로 돌아가기</span>
    </div>
  </div>

  <div class="container hidden" id="findPwForm">
    <h2>비밀번호 찾기</h2>
    <label for="findPwEmail">가입한 이메일</label>
    <input type="email" id="findPwEmail" placeholder="가입 시 이메일 입력">
    <button onclick="checkEmailForPw()">다음</button>
    <div id="findPwMsg" class="error-message hidden"></div>

    <div class="toggle">
      <span onclick="toggleForm('login')">← 로그인으로 돌아가기</span>
    </div>
  </div>

  <div class="container hidden" id="resetPwForm">
    <h2>비밀번호 재설정</h2>
    <label for="newPw">새 비밀번호</label>
    <input type="password" id="newPw" placeholder="새 비밀번호 입력">
    <label for="newPwConfirm">새 비밀번호 확인</label>
    <input type="password" id="newPwConfirm" placeholder="다시 한 번 입력">
    <button onclick="resetPassword()">비밀번호 변경</button>
    <div id="resetMsg"></div>
    <div class="toggle">
      <span onclick="toggleForm('login')">← 로그인으로 돌아가기</span>
    </div>
  </div>

  <script>
    const loginForm = document.getElementById('loginForm');
    const findIdForm = document.getElementById('findIdForm');
    const findIdMsg = document.getElementById('findIdMsg');
    const findIdStep1 = document.getElementById('findIdStep1');
    const findIdResult = document.getElementById('findIdResult');
    const displayId = document.getElementById('displayId');
    const findPwForm = document.getElementById('findPwForm');
    const resetPwForm = document.getElementById('resetPwForm');
    const findPwMsg = document.getElementById('findPwMsg');
    const resetMsg = document.getElementById('resetMsg');
    let currentUser = null;

    function toggleForm(type) {
      loginForm.classList.add('hidden');
      findIdForm.classList.add('hidden');
      findPwForm.classList.add('hidden');
      resetPwForm.classList.add('hidden');

      findIdMsg.classList.add('hidden');
      findPwMsg.classList.add('hidden');
      resetMsg.textContent = '';

      if (type === 'login') loginForm.classList.remove('hidden');
      else if (type === 'findId') {
        findIdForm.classList.remove('hidden');
        findIdStep1.classList.remove('hidden');
        findIdResult.classList.add('hidden');
        document.getElementById('findIdEmail').value = '';
      } else if (type === 'findPw') {
        findPwForm.classList.remove('hidden');
        document.getElementById('findPwEmail').value = '';
      } else if (type === 'resetPw') {
        resetPwForm.classList.remove('hidden');
        document.getElementById('newPw').value = '';
        document.getElementById('newPwConfirm').value = '';
      }
    }

    function login() {
      const id = document.getElementById('loginId').value;
      const pw = document.getElementById('loginPw').value;
      const userData = JSON.parse(localStorage.getItem('user'));
      if (!userData) return alert("등록된 회원이 없습니다. 회원가입을 해주세요.");
      if (id === userData.id && pw === userData.pw) {
        alert(`환영합니다 ${id}님!`);
        window.location.href = "s.html";
      } else alert("아이디 또는 비밀번호가 올바르지 않습니다.");
    }

    function findIdByEmail() {
      const email = document.getElementById('findIdEmail').value;
      const userData = JSON.parse(localStorage.getItem('user'));

      findIdMsg.classList.add('hidden');

      if (!email) {
        findIdMsg.textContent = "이메일을 입력해주세요!";
        findIdMsg.classList.remove('hidden');
        return;
      }

      if (userData && userData.email === email) {
        displayId.textContent = userData.id;
        findIdStep1.classList.add('hidden');
        findIdResult.classList.remove('hidden');
      } else {
        findIdMsg.textContent = "등록된 이메일이 없거나, 가입 정보가 일치하지 않습니다.";
        findIdMsg.classList.remove('hidden');
      }
    }

    function checkEmailForPw() {
      const email = document.getElementById('findPwEmail').value;
      const userData = JSON.parse(localStorage.getItem('user'));

      findPwMsg.classList.add('hidden');

      if (!email) {
        findPwMsg.textContent = "이메일을 입력해주세요!";
        findPwMsg.classList.remove('hidden');
        return;
      }
      if (userData && userData.email === email) {
        currentUser = userData;
        toggleForm('resetPw');
      } else {
        findPwMsg.textContent = "등록된 이메일이 없습니다.";
        findPwMsg.classList.remove('hidden');
      }
    }

    function resetPassword() {
      const newPw = document.getElementById('newPw').value;
      const confirmPw = document.getElementById('newPwConfirm').value;

      resetMsg.textContent = '';

      if (!newPw || !confirmPw) {
        resetMsg.textContent = "모든 칸을 입력해주세요!";
        resetMsg.className = "error-message";
        return;
      }
      if (newPw !== confirmPw) {
        resetMsg.textContent = "비밀번호가 일치하지 않습니다!";
        resetMsg.className = "error-message";
        return;
      }

      let userData = JSON.parse(localStorage.getItem('user'));
      if (userData.id === currentUser.id) {
        userData.pw = newPw;
        localStorage.setItem('user', JSON.stringify(userData));
        resetMsg.textContent = "✅ 비밀번호가 성공적으로 변경되었습니다!";
        resetMsg.className = "success-message";
        setTimeout(() => toggleForm('login'), 2000);
      }
    }
  </script>
</body>
</html>
